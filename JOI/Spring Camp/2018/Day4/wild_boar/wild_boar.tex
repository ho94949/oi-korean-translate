\begin{problem}{멧돼지}
	{standard input}{standard output}
	{10 seconds}{1024 megabytes}{}
	
	멧돼지 JOI군이 살고 있는 IOI숲에는 $N$개의 야생동물 급식소가 있고, $M$개의 도로가 있다. 급식소에는 1번 부터 $N$번 까지의 번호가 붙어있다. $i$ 번째 ($1 \le i \le M$) 도로는, $A_i$번 급식소와 $B_i$번 급식소를 양방향으로 이으며, JOI군이 이 도로를 지나는 데 양방향 모두 $C_i$ 시간이 걸린다. 어떤 급식소에서도 다른 모든 급식소 까지 한 개 이상의 도로를 통해 서로 오가는 것이 가능하다.
	
	JOI군은 유턴을 잘 못한기 때문에, 도로를 가던 도중 유턴해서 출발했던 급식소로 돌아오지 못한다. 또한, 급식소에 도착한 이후에는, 가장 최근에 사용한 도로를 써서 되돌아가는 것도 하지 못한다.
	
	매일, JOI군은 보급계획에 따라서 음식을 먹는다. 하루의 보급 계획은 음식을 보급받을 $L$개의 급식소 번호를 차례로 나열한 $X_1$, $X_2$, $\cdots$, $X_L$이다. JOI군은 $X_1$번 급식소에서 시작해서, 해당 순서로 급식소를 방문 하여, $X_L$번을 마지막으로 보급계획을 끝낸다. 중간에 다른 급식소를 거쳐도 된다. 보급 계획에 같은 급식소가 여러번 등장할 수는 있지만, 모든 $j$ ($1 \le j \le L-1$) 에 대해, $X_j \ne X_{j+1}$을 만족한다. 보급계획 중에는 불가능 한게 있을 수도 있다.
	
	처음에, JOI군은 최초 보급계획 $X_1$, $X_2$, $\cdots$, $X_L$을 정한다. $k$ 번째 ($1 \le k \le T$) 날 아침, JOI군은 $P_k$번째 값을 $Q_k$로 바꿀 것이다. (즉, $X_{P_k}$ 가 $Q_k$가 된다. 그리고 새로운 보급계획을 따라 음식을 먹는다. 모든 $j$ ($1 \le j \le L-1$) 에 대해, 값이 바뀐 이후에도 $X_j \ne X_{j+1}$을 만족함이 보장된다.
	
	$T$ 일 동안 각 날의 보급계획에 대해, 해당하는 보급계획이 가능한지 불가능 한지 판단하고, 가능하다면 해당 보급계획을 진행할 수 있는 가장 짧은 시간을 출력하여라.
	
	\InputFile
	
	표준 입력에서 다음 입력이 주어진다.
	
	\begin{itemize}
		\item 첫째 줄에는 네 정수 $N$, $M$, $T$, $L$이 공백으로 구분되어 주어진다. 이는 IOI숲에 $N$개의 급식소와 $M$개의 도로가 있으며, JOI군은 $T$ 일 동안의 보급계획을 생각 중이고, 각 보급계획이 $L$개의 급식소 번호를 차례로 나열했다는 의미이다.
		\item 다음 $M$개의 줄의 $i$ 번째 ($1 \le i \le M$) 줄에는 공백으로 구분된 세 정수 $A_i$, $B_i$, $C_i$가 주어진다. 이는 왼쪽에서 $i$ 번째 도로가 $A_i$번 급식소와 $B_i$번 급식소를 양방향으로 연결하며, 이 도로를 지나는 데 양방향 모두 $C_i$ 시간이 걸린다는 것이다.
		\item 다음 $L$개의 줄의 $j$ 번째 ($1 \le j \le L$) 줄에는 정수 $X_j$가 주어진다. 이는 최초 보급계획이 $X_1$, $X_2$, $\cdots$, $X_L$임을 의미한다.
		\item 다음 $T$개의 줄의 $k$ 번째 ($1 \le k \le T$) 줄에는 공백으로 구분된 두 정수 $P_k$, $Q_k$가 주어진다. 이는 $k$ 번째 날 아침에 JOI군이 보급계획의 $P_k$번째 값을 $Q_k$로 바꾼다는 의미이다.
	\end{itemize}
	
	\OutputFile
	
	표준 출력으로 $T$개의 줄을 출력하여라. $k$ 번째 ($1 \le k \le T$) 줄은 $k$번째 보급계획이 불가능 하면 \texttt{-1}, 가능하면 보급계획을 실행하는데 드는 최소시간이다.
	
	\Constraints
	
	\begin{itemize}
		\item $2 \le N \le 2\ 000$.
		\item $N-1 \le M \le 2\ 000$.
		\item $1 \le T \le 100\ 000$.
		\item $2 \le L \le 100\ 000$.
		\item $1 \le A_i < B_i \le N$ ($1 < i \le M$).
		\item $(A_i, B_i) \ne (A_j, B_j)$ ($1 \le i< j \le M$).
		\item 어떤 급식소에서도 다른 모든 급식소 까지 한 개 이상의 도로를 통해 서로 오가는 것이 가능하다.
		\item $1 \le C_i \le 1\ 000\ 000\ 000$ ($1 \le i \le M$).
		\item $1 \le X_j \le N$ ($1 \le j \le L$).
		\item $1 \le P_k \le L$ ($1 \le k \le T$).
		\item $1 \le Q_k \le N$ ($1 \le k \le T$).
		\item 모든 $j$ ($1 \le j \le L-1$) 에 대해, $X_j \ne X_{j+1}$을 만족한다. 또한, 보급 계획이 변경된 이후에도 모든 $j$ ($1 \le j \le L-1$) 에 대해, $X_j \ne X_{j+1}$을 만족한다.
	\end{itemize}
	
	
	\SubtaskWithCost{1}{12}
	\begin{itemize}
		\item $N \le 10$.
		\item $M \le 10$.
		\item $T = 1$.
		\item $L \le 10$.
		\item $C_i \le 10$ ($1 \le i \le M$).
	\end{itemize}


	\SubtaskWithCost{2}{35}
	\begin{itemize}
		\item $N \le 500$.
		\item $M \le 500$.
		\item $T = 1$.
	\end{itemize}


	\SubtaskWithCost{3}{15}
	\begin{itemize}
		\item $T = 1$.
	\end{itemize}
	
	\SubtaskWithCost{4}{38}
	추가 제한조건이 없다.
	
	\Examples
	
	\begin{example}
		\exmp{
			3 3 1 3
			1 2 1
			2 3 1
			1 3 1
			1
			2
			3
			3 1
		}{%
			3
		}%
	\end{example}
	
	이 입력 예제에서는 최초 보급계획은 1, 2, 3이다. JOI군은 첫 번째 날 아침에 세 번째 값을 1로 바꾼다. 즉, 첫 번째 날의 보급계획은 1, 2, 1이다.
	
	처음에 JOI군은 1번 급식소에서 음식을 보급받을 것이다. 그리고, 1번째 도로를 사용하여, 2번 급식소로 갈 것이다. 그 후 2번 급식소에서 음식을 보급받을 것이다. 그리고, 2번째 도로를 사용하여, 3번 급식소로 갈 것이다. 마지막으로, 3번째 도로를 사용하여, 1번 급식소로 갈 것이다. 그 후 1번 급식소에서 음식을 보급받을 것이다. 이 방법으로 음식을 보급받는 데에는 3시간이 걸린다. 이것이 최소시간이므로 3을 출력한다.
	
	JOI군은 유턴을 할 수 없으므로 $1 \rightarrow 2 \rightarrow 1$과 같은 순서로 급식소를 방문하는 것은 불가능하다.
	
	\begin{example}
		\exmp{
			4 4 4 3
			1 2 1
			2 3 1
			1 3 1
			1 4 1
			4
			1
			3
			3 4
			1 2
			3 2
			2 4
		}{%
			5
			2
			3
			-1
		}%
	\end{example}

이 입력 예제에서는 첫 번째 날의 보급계획은 4, 1, 4이다. 처음에 JOI군은 4번 급식소에서 음식을 보급받을 것이다. 그리고, 4번째 도로를 사용하여, 1번 급식소로 갈 것이다. 그 후 1번 급식소에서 음식을 보급받을 것이다. 그 후, 1, 2, 3, 4번째 도로 순서로 사용하여 급식소를 $1 \rightarrow 2 \rightarrow 3 \rightarrow 1 \rightarrow 4$ 순서로 움직여, 4번 급식소에서 음식을 보급받을 것이다. 이것이 최소 시간이다.

네 번째 날의 보급계획은 2, 4, 2이다. 이 보급계획을 실행할 수 없기 때문에, -1을 출력한다.

		\begin{example}
		\exmp{
			5 6 1 5
			1 2 8
			1 3 8
			1 4 8
			2 5 2
			3 4 6
			4 5 6
			2
			5
			1
			5
			3
			5 2
		}{%
			38
		}%
	\end{example}
	
\end{problem}
